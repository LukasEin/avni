from __future__ import absolute_import
import scipy.constants
import ConfigParser
import pdb    #for the debugger pdb.set_trace()
import pkgutil
import StringIO

"""
download files
"""
downloadpage = 'https://maurya.umd.edu/files'
localfilefolder = 'files'

"""
Mapping constants
"""
geoco=0.993277    #correction for geographic-geocentric conversion


"""
Color scales
"""
colorscale = {'rainbow1': {'name': 'rainbow_bgyrm_35-85_c69_n256','description': \
	'The least worst rainbow colour map.  Note there are small perceptual blind spots at yellow and red',\
'RGB': [(0.000000,0.186555,0.962645), \
(0.000000,0.202474,0.948892), \
(0.000000,0.217314,0.935162), \
(0.000000,0.231251,0.921454), \
(0.011192,0.244416,0.907769), \
(0.036140,0.257001,0.894099), \
(0.055678,0.269036,0.880450), \
(0.069388,0.280559,0.866824), \
(0.079257,0.291717,0.853222), \
(0.086705,0.302461,0.839647), \
(0.092118,0.312895,0.826088), \
(0.095864,0.323023,0.812557), \
(0.098322,0.332857,0.799061), \
(0.099569,0.342411,0.785592), \
(0.099878,0.351700,0.772158), \
(0.099398,0.360748,0.758769), \
(0.098334,0.369568,0.745424), \
(0.096762,0.378143,0.732142), \
(0.095150,0.386472,0.718915), \
(0.093450,0.394578,0.705765), \
(0.092187,0.402438,0.692700), \
(0.091506,0.410081,0.679709), \
(0.091673,0.417471,0.666827), \
(0.092844,0.424627,0.654053), \
(0.095394,0.431565,0.641381), \
(0.099143,0.438266,0.628834), \
(0.104166,0.444763,0.616395), \
(0.110368,0.451048,0.604073), \
(0.117428,0.457142,0.591857), \
(0.125293,0.463058,0.579746), \
(0.133667,0.468835,0.567725), \
(0.142349,0.474458,0.555783), \
(0.151155,0.479959,0.543930), \
(0.159927,0.485344,0.532131), \
(0.168595,0.490665,0.520364), \
(0.176962,0.495890,0.508647), \
(0.185000,0.501082,0.496924), \
(0.192599,0.506214,0.485209), \
(0.199744,0.511329,0.473481), \
(0.206472,0.516422,0.461738), \
(0.212630,0.521505,0.449946), \
(0.218319,0.526594,0.438106), \
(0.223499,0.531668,0.426188), \
(0.228195,0.536761,0.414206), \
(0.232391,0.541842,0.402124), \
(0.236143,0.546950,0.389957), \
(0.239440,0.552064,0.377691), \
(0.242321,0.557185,0.365302), \
(0.244805,0.562312,0.352799), \
(0.246945,0.567440,0.340162), \
(0.248755,0.572576,0.327380), \
(0.250235,0.577700,0.314474), \
(0.251536,0.582828,0.301434), \
(0.252620,0.587940,0.288280), \
(0.253608,0.593041,0.275015), \
(0.254581,0.598096,0.261656), \
(0.255602,0.603125,0.248249), \
(0.256812,0.608103,0.234795), \
(0.258301,0.613005,0.221337), \
(0.260222,0.617848,0.207945), \
(0.262662,0.622604,0.194693), \
(0.265748,0.627264,0.181569), \
(0.269580,0.631819,0.168769), \
(0.274215,0.636261,0.156288), \
(0.279745,0.640574,0.144203), \
(0.286146,0.644760,0.132651), \
(0.293465,0.648825,0.121677), \
(0.301631,0.652749,0.111525), \
(0.310620,0.656561,0.102116), \
(0.320300,0.660235,0.093657), \
(0.330589,0.663803,0.086199), \
(0.341426,0.667253,0.079852), \
(0.352683,0.670611,0.074629), \
(0.364265,0.673870,0.070490), \
(0.376108,0.677059,0.067449), \
(0.388103,0.680163,0.065346), \
(0.400212,0.683221,0.064139), \
(0.412371,0.686221,0.063672), \
(0.424524,0.689182,0.063795), \
(0.436657,0.692099,0.064392), \
(0.448738,0.694977,0.065356), \
(0.460735,0.697834,0.066603), \
(0.472667,0.700671,0.068066), \
(0.484504,0.703483,0.069670), \
(0.496254,0.706277,0.071332), \
(0.507931,0.709054,0.073060), \
(0.519500,0.711809,0.074792), \
(0.530991,0.714547,0.076552), \
(0.542399,0.717285,0.078345), \
(0.553721,0.719995,0.080170), \
(0.564973,0.722691,0.082034), \
(0.576175,0.725387,0.083799), \
(0.587287,0.728054,0.085523), \
(0.598352,0.730714,0.087403), \
(0.609370,0.733361,0.089162), \
(0.620333,0.735986,0.090964), \
(0.631243,0.738609,0.092702), \
(0.642110,0.741207,0.094561), \
(0.652930,0.743801,0.096272), \
(0.663728,0.746374,0.098130), \
(0.674473,0.748933,0.099882), \
(0.685194,0.751487,0.101673), \
(0.695880,0.754017,0.103500), \
(0.706537,0.756534,0.105240), \
(0.717167,0.759037,0.107085), \
(0.727763,0.761527,0.108841), \
(0.738339,0.764004,0.110662), \
(0.748898,0.766467,0.112456), \
(0.759436,0.768908,0.114198), \
(0.769954,0.771339,0.116039), \
(0.780447,0.773731,0.117807), \
(0.790912,0.776103,0.119578), \
(0.801346,0.778436,0.121333), \
(0.811747,0.780723,0.123100), \
(0.822102,0.782952,0.124876), \
(0.832394,0.785113,0.126614), \
(0.842617,0.787180,0.128339), \
(0.852741,0.789132,0.130043), \
(0.862744,0.790937,0.131648), \
(0.872587,0.792575,0.133222), \
(0.882234,0.794006,0.134750), \
(0.891645,0.795182,0.136117), \
(0.900764,0.796075,0.137499), \
(0.909542,0.796642,0.138691), \
(0.917926,0.796843,0.139742), \
(0.925856,0.796642,0.140735), \
(0.933283,0.796010,0.141513), \
(0.940177,0.794922,0.142116), \
(0.946481,0.793364,0.142555), \
(0.952185,0.791318,0.142816), \
(0.957272,0.788805,0.142895), \
(0.961738,0.785825,0.142796), \
(0.965601,0.782401,0.142526), \
(0.968884,0.778563,0.142096), \
(0.971619,0.774345,0.141528), \
(0.973850,0.769789,0.140823), \
(0.975625,0.764936,0.139944), \
(0.977003,0.759813,0.139019), \
(0.978027,0.754482,0.138042), \
(0.978754,0.748953,0.136925), \
(0.979235,0.743287,0.135752), \
(0.979510,0.737489,0.134613), \
(0.979616,0.731601,0.133368), \
(0.979590,0.725642,0.132121), \
(0.979457,0.719617,0.130869), \
(0.979240,0.713547,0.129580), \
(0.978956,0.707442,0.128297), \
(0.978620,0.701311,0.126979), \
(0.978244,0.695158,0.125740), \
(0.977837,0.688992,0.124422), \
(0.977396,0.682798,0.123131), \
(0.976930,0.676600,0.121859), \
(0.976445,0.670392,0.120607), \
(0.975943,0.664163,0.119372), \
(0.975425,0.657931,0.118152), \
(0.974888,0.651681,0.116883), \
(0.974335,0.645412,0.115665), \
(0.973765,0.639140,0.114396), \
(0.973178,0.632850,0.113254), \
(0.972574,0.626542,0.112029), \
(0.971949,0.620228,0.110831), \
(0.971307,0.613880,0.109664), \
(0.970649,0.607537,0.108406), \
(0.969974,0.601158,0.107281), \
(0.969283,0.594769,0.106128), \
(0.968577,0.588355,0.104902), \
(0.967854,0.581929,0.103810), \
(0.967111,0.575486,0.102663), \
(0.966350,0.569008,0.101520), \
(0.965575,0.562526,0.100399), \
(0.964783,0.555995,0.099296), \
(0.963976,0.549464,0.098231), \
(0.963155,0.542899,0.097093), \
(0.962313,0.536304,0.096016), \
(0.961457,0.529684,0.095014), \
(0.960588,0.523034,0.093919), \
(0.959698,0.516344,0.092832), \
(0.958794,0.509636,0.091874), \
(0.957875,0.502885,0.090828), \
(0.956935,0.496103,0.089807), \
(0.955987,0.489287,0.088805), \
(0.955018,0.482438,0.087830), \
(0.954035,0.475547,0.086854), \
(0.953037,0.468597,0.085824), \
(0.952023,0.461618,0.084968), \
(0.951006,0.454601,0.084163), \
(0.949974,0.447528,0.083344), \
(0.948941,0.440440,0.082697), \
(0.947910,0.433319,0.082226), \
(0.946884,0.426179,0.081913), \
(0.945871,0.419041,0.081847), \
(0.944889,0.411908,0.082109), \
(0.943940,0.404805,0.082728), \
(0.943048,0.397784,0.083928), \
(0.942227,0.390858,0.085608), \
(0.941494,0.384075,0.088120), \
(0.940882,0.377503,0.091363), \
(0.940411,0.371185,0.095416), \
(0.940102,0.365211,0.100349), \
(0.939981,0.359638,0.106304), \
(0.940073,0.354545,0.113159), \
(0.940396,0.349992,0.120891), \
(0.940963,0.346044,0.129653), \
(0.941791,0.342805,0.139220), \
(0.942881,0.340263,0.149720), \
(0.944224,0.338473,0.160949), \
(0.945815,0.337469,0.172917), \
(0.947642,0.337226,0.185612), \
(0.949675,0.337722,0.198848), \
(0.951894,0.338940,0.212690), \
(0.954272,0.340808,0.227018), \
(0.956771,0.343280,0.241759), \
(0.959367,0.346267,0.256857), \
(0.962023,0.349739,0.272244), \
(0.964720,0.353586,0.287904), \
(0.967432,0.357782,0.303759), \
(0.970124,0.362223,0.319786), \
(0.972793,0.366884,0.335916), \
(0.975406,0.371704,0.352141), \
(0.977964,0.376679,0.368454), \
(0.980452,0.381728,0.384800), \
(0.982857,0.386853,0.401211), \
(0.985177,0.392048,0.417642), \
(0.987402,0.397274,0.434095), \
(0.989529,0.402534,0.450593), \
(0.991552,0.407823,0.467113), \
(0.993475,0.413137,0.483640), \
(0.995282,0.418440,0.500200), \
(0.996983,0.423767,0.516792), \
(0.998575,0.429107,0.533400), \
(1.000000,0.434449,0.550052), \
(1.000000,0.439806,0.566736), \
(1.000000,0.445169,0.583447), \
(1.000000,0.450544,0.600206), \
(1.000000,0.455927,0.617007), \
(1.000000,0.461325,0.633848), \
(1.000000,0.466733,0.650727), \
(1.000000,0.472152,0.667657), \
(1.000000,0.477574,0.684622), \
(1.000000,0.483011,0.701639), \
(1.000000,0.488468,0.718705), \
(1.000000,0.493928,0.735815), \
(1.000000,0.499394,0.752973), \
(1.000000,0.504887,0.770184), \
(1.000000,0.510380,0.787441), \
(1.000000,0.515883,0.804745), \
(1.000000,0.521408,0.822100), \
(1.000000,0.526950,0.839502), \
(1.000000,0.532492,0.856949), \
(1.000000,0.538050,0.874449), \
(1.000000,0.543612,0.892002), \
(1.000000,0.549195,0.909598), \
(0.998480,0.554784,0.927242), \
(0.996596,0.560390,0.944944), \
(0.994532,0.566003,0.962686), \
(0.992279,0.571631,0.980481)]}, \
'rainbow2': {'name': 'rainbow_bgyr_35-85_c72_n256','description': \
'Reasonable rainbow colour map from blue to red.  Note there is a small perceptual blind spot at yellow', \
'RGB': [(0.000000,0.203873,0.962505), \
(0.000000,0.215239,0.951401), \
(0.000000,0.226130,0.940312), \
(0.000000,0.236541,0.929229), \
(0.000000,0.246539,0.918169), \
(0.000000,0.256203,0.907120), \
(0.000000,0.265574,0.896082), \
(0.000000,0.274646,0.885058), \
(0.000000,0.283483,0.874045), \
(0.000000,0.292086,0.863051), \
(0.000000,0.300474,0.852064), \
(0.000000,0.308697,0.841088), \
(0.000000,0.316722,0.830126), \
(0.000000,0.324583,0.819168), \
(0.000000,0.332324,0.808231), \
(0.000000,0.339905,0.797297), \
(0.000000,0.347361,0.786382), \
(0.000000,0.354696,0.775463), \
(0.000000,0.361910,0.764564), \
(0.000000,0.369018,0.753670), \
(0.000000,0.376017,0.742795), \
(0.000000,0.382910,0.731928), \
(0.000000,0.389688,0.721075), \
(0.000000,0.396363,0.710256), \
(0.000000,0.402916,0.699459), \
(0.000000,0.409338,0.688715), \
(0.000000,0.415611,0.678016), \
(0.000000,0.421721,0.667385), \
(0.000000,0.427676,0.656839), \
(0.000000,0.433415,0.646385), \
(0.000000,0.438964,0.636050), \
(0.000000,0.444319,0.625832), \
(0.000000,0.449447,0.615746), \
(0.000000,0.454378,0.605790), \
(0.000000,0.459111,0.595971), \
(0.004338,0.463666,0.586271), \
(0.029615,0.468070,0.576680), \
(0.055795,0.472354,0.567173), \
(0.077065,0.476524,0.557739), \
(0.095292,0.480614,0.548369), \
(0.111187,0.484648,0.539027), \
(0.125303,0.488652,0.529714), \
(0.137988,0.492620,0.520402), \
(0.149372,0.496582,0.511097), \
(0.159631,0.500548,0.501787), \
(0.169000,0.504521,0.492444), \
(0.177466,0.508492,0.483085), \
(0.185172,0.512463,0.473695), \
(0.192171,0.516453,0.464289), \
(0.198564,0.520457,0.454827), \
(0.204434,0.524478,0.445315), \
(0.209743,0.528510,0.435773), \
(0.214606,0.532552,0.426161), \
(0.219048,0.536606,0.416512), \
(0.223088,0.540663,0.406791), \
(0.226742,0.544738,0.396996), \
(0.230020,0.548829,0.387135), \
(0.232998,0.552915,0.377201), \
(0.235675,0.557030,0.367159), \
(0.238015,0.561136,0.357035), \
(0.240060,0.565256,0.346782), \
(0.241853,0.569393,0.336400), \
(0.243339,0.573542,0.325884), \
(0.244577,0.577688,0.315230), \
(0.245562,0.581851,0.304391), \
(0.246300,0.586027,0.293358), \
(0.246799,0.590194,0.282138), \
(0.247074,0.594379,0.270674), \
(0.247143,0.598560,0.258956), \
(0.247035,0.602746,0.246963), \
(0.246790,0.606929,0.234727), \
(0.246470,0.611094,0.222163), \
(0.246155,0.615232,0.209355), \
(0.245952,0.619356,0.196319), \
(0.245995,0.623422,0.183036), \
(0.246445,0.627422,0.169693), \
(0.247481,0.631352,0.156300), \
(0.249253,0.635178,0.142994), \
(0.251961,0.638897,0.130010), \
(0.255696,0.642489,0.117414), \
(0.260573,0.645938,0.105575), \
(0.266592,0.649255,0.094696), \
(0.273717,0.652417,0.084904), \
(0.281824,0.655447,0.076489), \
(0.290780,0.658349,0.069753), \
(0.300426,0.661134,0.064513), \
(0.310611,0.663825,0.060865), \
(0.321123,0.666420,0.058721), \
(0.331861,0.668960,0.057692), \
(0.342715,0.671437,0.057693), \
(0.353565,0.673877,0.058443), \
(0.364386,0.676284,0.059738), \
(0.375123,0.678664,0.061142), \
(0.385749,0.681022,0.062974), \
(0.396267,0.683375,0.064759), \
(0.406655,0.685711,0.066664), \
(0.416923,0.688033,0.068644), \
(0.427067,0.690343,0.070512), \
(0.437095,0.692656,0.072423), \
(0.447010,0.694942,0.074359), \
(0.456832,0.697229,0.076211), \
(0.466567,0.699505,0.078090), \
(0.476213,0.701772,0.079998), \
(0.485774,0.704034,0.081943), \
(0.495271,0.706288,0.083778), \
(0.504697,0.708529,0.085565), \
(0.514055,0.710760,0.087502), \
(0.523348,0.712977,0.089316), \
(0.532587,0.715195,0.091171), \
(0.541761,0.717404,0.092931), \
(0.550901,0.719596,0.094839), \
(0.559990,0.721776,0.096566), \
(0.569022,0.723955,0.098445), \
(0.578019,0.726127,0.100225), \
(0.586980,0.728282,0.102035), \
(0.595902,0.730435,0.103855), \
(0.604790,0.732578,0.105640), \
(0.613634,0.734709,0.107440), \
(0.622456,0.736828,0.109246), \
(0.631250,0.738946,0.111025), \
(0.640011,0.741042,0.112818), \
(0.648742,0.743145,0.114525), \
(0.657454,0.745226,0.116361), \
(0.666130,0.747307,0.118133), \
(0.674791,0.749367,0.119864), \
(0.683430,0.751435,0.121611), \
(0.692053,0.753477,0.123379), \
(0.700648,0.755521,0.125168), \
(0.709231,0.757551,0.126907), \
(0.717792,0.759568,0.128678), \
(0.726335,0.761583,0.130479), \
(0.734867,0.763586,0.132206), \
(0.743382,0.765586,0.133961), \
(0.751882,0.767564,0.135676), \
(0.760367,0.769541,0.137469), \
(0.768838,0.771513,0.139171), \
(0.777308,0.773464,0.140965), \
(0.785757,0.775413,0.142689), \
(0.794199,0.777358,0.144438), \
(0.802624,0.779283,0.146171), \
(0.811047,0.781205,0.147914), \
(0.819455,0.783114,0.149672), \
(0.827860,0.785020,0.151378), \
(0.836256,0.786914,0.153109), \
(0.844650,0.788797,0.154858), \
(0.853036,0.790662,0.156615), \
(0.861415,0.792515,0.158345), \
(0.869782,0.794342,0.160020), \
(0.878140,0.796125,0.161782), \
(0.886474,0.797859,0.163460), \
(0.894770,0.799521,0.165067), \
(0.903007,0.801060,0.166695), \
(0.911155,0.802450,0.168191), \
(0.919171,0.803636,0.169639), \
(0.927005,0.804555,0.170896), \
(0.934588,0.805135,0.171997), \
(0.941846,0.805316,0.172894), \
(0.948695,0.805036,0.173545), \
(0.955064,0.804241,0.173921), \
(0.960881,0.802887,0.173992), \
(0.966095,0.800973,0.173747), \
(0.970687,0.798499,0.173191), \
(0.974650,0.795494,0.172336), \
(0.978013,0.792008,0.171212), \
(0.980823,0.788098,0.169857), \
(0.983139,0.783838,0.168251), \
(0.985042,0.779280,0.166516), \
(0.986600,0.774500,0.164627), \
(0.987886,0.769553,0.162650), \
(0.988970,0.764486,0.160560), \
(0.989900,0.759324,0.158484), \
(0.990719,0.754111,0.156344), \
(0.991460,0.748847,0.154141), \
(0.992144,0.743562,0.151958), \
(0.992789,0.738248,0.149806), \
(0.993396,0.732926,0.147601), \
(0.993978,0.727586,0.145427), \
(0.994541,0.722236,0.143205), \
(0.995087,0.716888,0.141029), \
(0.995616,0.711519,0.138803), \
(0.996126,0.706139,0.136595), \
(0.996620,0.700748,0.134440), \
(0.997096,0.695344,0.132228), \
(0.997555,0.689930,0.130058), \
(0.997997,0.684498,0.127831), \
(0.998421,0.679060,0.125641), \
(0.998829,0.673610,0.123396), \
(0.999219,0.668147,0.121195), \
(0.999590,0.662666,0.119036), \
(0.999944,0.657170,0.116820), \
(1.000000,0.651659,0.114580), \
(1.000000,0.646127,0.112437), \
(1.000000,0.640588,0.110240), \
(1.000000,0.635028,0.107973), \
(1.000000,0.629450,0.105798), \
(1.000000,0.623864,0.103599), \
(1.000000,0.618249,0.101348), \
(1.000000,0.612613,0.099135), \
(1.000000,0.606972,0.096882), \
(1.000000,0.601295,0.094743), \
(1.000000,0.595606,0.092465), \
(1.000000,0.589890,0.090257), \
(1.000000,0.584160,0.088032), \
(1.000000,0.578400,0.085726), \
(1.000000,0.572627,0.083542), \
(1.000000,0.566822,0.081316), \
(1.000000,0.560983,0.079004), \
(1.000000,0.555126,0.076745), \
(1.000000,0.549247,0.074530), \
(1.000000,0.543332,0.072245), \
(1.000000,0.537393,0.070004), \
(1.000000,0.531413,0.067732), \
(1.000000,0.525408,0.065424), \
(1.000000,0.519370,0.063180), \
(1.000000,0.513296,0.060810), \
(1.000000,0.507185,0.058502), \
(1.000000,0.501042,0.056232), \
(1.000000,0.494857,0.053826), \
(1.000000,0.488627,0.051494), \
(1.000000,0.482359,0.049242), \
(1.000000,0.476046,0.046828), \
(1.000000,0.469692,0.044447), \
(1.000000,0.463268,0.042093), \
(1.000000,0.456815,0.039648), \
(1.000000,0.450307,0.037261), \
(1.000000,0.443742,0.034882), \
(1.000000,0.437117,0.032495), \
(1.000000,0.430426,0.030303), \
(1.000000,0.423666,0.028180), \
(1.000000,0.416857,0.026121), \
(1.000000,0.409966,0.024126), \
(1.000000,0.402993,0.022194), \
(1.000000,0.395949,0.020325), \
(1.000000,0.388816,0.018517), \
(0.999937,0.381591,0.016771), \
(0.999612,0.374278,0.015085), \
(0.999273,0.366853,0.013457), \
(0.998920,0.359319,0.011916), \
(0.998553,0.351672,0.010169), \
(0.998173,0.343900,0.008744), \
(0.997780,0.336002,0.007354), \
(0.997376,0.327956,0.006020), \
(0.996958,0.319762,0.004743), \
(0.996528,0.311383,0.003522), \
(0.996086,0.302821,0.002356), \
(0.995632,0.294070,0.001245), \
(0.995165,0.285096,0.000187), \
(0.994686,0.275912,0.000000), \
(0.994195,0.266419,0.000000), \
(0.993693,0.256636,0.000000), \
(0.993178,0.246521,0.000000), \
(0.992649,0.236050,0.000000), \
(0.992106,0.225108,0.000000), \
(0.991553,0.213705,0.000000), \
(0.990988,0.201692,0.000000), \
(0.990411,0.189028,0.000000)]}}